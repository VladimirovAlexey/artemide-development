!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!Program makes a smooth plot at givem s,Q,y, in qT (no bin-integrations)
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
program example
use IntegrationRoutines
implicit none

real*8,dimension(-5:5):: re, r1
integer::i

write(*,*) '-------------------------------------------------------------------'
write(*,*) '---   Test of the GK_array5 submodule                           ---'
write(*,*) '-------------------------------------------------------------------'
write(*,*) ' '
write(*,*) '  | Exact          | GK (eps=0.001) | difference     |'
write(*,*) '  |                |                |                |'
write(*,*) '1) (0.5+x)^??   [0,1]  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -',&
'  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -|'

re=(/320d0/81d0, 208d0/81d0, 16d0/9d0, 4d0/3, Log(3d0), &
-1d0 + Log(3d0*Sqrt(3d0)/2d0), 1d0, 13d0/12d0, 5d0/4d0, 121d0/80d0, 91d0/48d0/)

r1=Integrate_GK_array5(f1,0d0,1d0,0.001d0)

do i=-5,5

write(*,'(I2," | ",F14.10," | ",F14.10," | ",F14.10," | ")') i, re(i), r1(i) , (re(i)-r1(i))/re(i)

write(*,*) '------------------------------------------------------------------------'
end do 

write(*,*) '2) trigon   [-0.5,1]  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -',&
'  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -|'

re=(/0.10588585446212372d0, 0.11768528245811852d0, 0.048868232685727424d0, &
-0.06799903468328006d0, -0.15504823019282685d0, 3.3284514183885014d0, &
0.0640221887548372d0, 0.009693027326489492d0, 0.0053185264829097925d0, &
0.044083216866819354d0, 0.07375488204625646d0/)

r1=Integrate_GK_array5(f2,-0.5d0,1d0,0.001d0)

do i=-5,5

write(*,'(I2," | ",F14.10," | ",F14.10," | ",F14.10," | ")') i, re(i), r1(i) , (re(i)-r1(i))/re(i)

write(*,*) '------------------------------------------------------------------------'
end do 

contains

!!! x^3 Polynomial function
function f1(x)
    real*8,dimension(-5:5)::f1
    real*8,intent(in)::x
    
    f1=(/&
    (0.5d0+x)**(-5),&
    (0.5d0+x)**(-4),&
    (0.5d0+x)**(-3),&
    (0.5d0+x)**(-1),&
    (0.5d0+x)**(-1),&
    log((0.5d0+x)),&
    (0.5d0+x)**1,&
    (0.5d0+x)**2,&
    (0.5d0+x)**3,&
    (0.5d0+x)**4,&
    (0.5d0+x)**5/)

end function f1

!!! trig
function f2(x)
    real*8,dimension(-5:5)::f2
    real*8,intent(in)::x
    
    f2=(/&
    cos(15d0*x),&
    cos(14d0*x),&
    cos(13d0*x),&
    cos(12d0*x),&
    cos(11d0*x),&
    sin(5d0*x)/x,&
    sin(11d0*x),&
    sin(12d0*x),&
    sin(13d0*x),&
    sin(14d0*x),&
    sin(15d0*x)&
    /)

end function f2


end program example
